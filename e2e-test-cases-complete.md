# TML Villa 完整端到端测试用例

## 测试覆盖范围

### 核心功能 (P0)
- F004: 用户注册/登录系统
- F005: 民宿预订流程
- F007: 民宿库存管理
- F008: 车辆库存管理
- F026: 业务配置系统

### 用户功能 (P1)
- F009: 用户中心
- F010: 评价系统
- F011: 消息通知
- F018: 收藏功能
- F024: 会员系统

### 管理功能 (P1)
- F012: 员工管理
- F013: 成本核算
- F014: 运营报表
- F015: 管理端日历视图
- F016: 免费额度监控
- F022: 营销工具
- F023: 商家入驻

### 通用功能 (P2)
- F017: 搜索优化
- F019: 多语言完善
- F020: 移动端适配
- F021: 错误边界组件
- F025: 单元测试

---

## 测试用例详情

## 一、F004 - 用户注册/登录系统

### TC-F004-001: 用户注册
**前置条件**: 无
**测试步骤**:
1. 访问注册页面 `/#/login?mode=register`
2. 输入有效邮箱地址
3. 输入密码（至少6位）
4. 确认密码
5. 点击注册按钮

**预期结果**:
- ✅ 注册成功提示
- ✅ 自动登录并跳转到首页
- ✅ localStorage 中存储 token

### TC-F004-002: 用户登录
**前置条件**: 用户已注册
**测试步骤**:
1. 访问登录页面 `/#/login`
2. 输入注册邮箱
3. 输入正确密码
4. 点击登录按钮

**预期结果**:
- ✅ 登录成功提示
- ✅ 跳转到首页或之前的页面
- ✅ 导航栏显示用户头像和菜单

### TC-F004-003: 错误密码登录
**前置条件**: 用户已注册
**测试步骤**:
1. 访问登录页面
2. 输入注册邮箱
3. 输入错误密码
4. 点击登录按钮

**预期结果**:
- ✅ 显示错误提示"Invalid credentials"
- ✅ 页面保持在登录页

### TC-F004-004: 用户登出
**前置条件**: 用户已登录
**测试步骤**:
1. 点击导航栏用户头像
2. 选择"Log out"

**预期结果**:
- ✅ 登出成功
- ✅ 导航栏恢复为登录/注册按钮
- ✅ localStorage 中 token 被清除

---

## 二、F005 - 民宿预订流程

### TC-F005-001: 查看民宿详情
**测试步骤**:
1. 访问首页
2. 点击任意民宿卡片

**预期结果**:
- ✅ 跳转到民宿详情页 `/#/homestay/:id`
- ✅ 显示民宿图片、名称、描述、价格、设施
- ✅ 显示预订日历

### TC-F005-002: 选择预订日期
**前置条件**: 在民宿详情页
**测试步骤**:
1. 在日历上选择入住日期
2. 选择退房日期
3. 查看价格计算

**预期结果**:
- ✅ 日期可以被选择
- ✅ 已预订日期显示为不可用
- ✅ 自动计算总价（单价 × 天数）

### TC-F005-003: 提交预订（已登录）
**前置条件**: 用户已登录，已选择日期
**测试步骤**:
1. 选择入住/退房日期
2. 选择客人数量
3. 点击"Reserve"按钮
4. 确认预订信息
5. 提交订单

**预期结果**:
- ✅ 订单创建成功
- ✅ 显示订单详情页
- ✅ 订单状态为"Pending"或"Confirmed"
- ✅ 库存相应减少

### TC-F005-004: 提交预订（未登录）
**前置条件**: 用户未登录
**测试步骤**:
1. 选择日期和客人
2. 点击"Reserve"按钮

**预期结果**:
- ✅ 提示需要登录
- ✅ 跳转到登录页
- ✅ 登录后返回并继续预订流程

---

## 三、F009 - 用户中心

### TC-F009-001: 用户中心页面加载
**前置条件**: 用户已登录
**测试步骤**:
1. 访问用户中心页面 `/#/user-center`

**预期结果**:
- ✅ 显示用户头像和基本信息
- ✅ 显示标签页：个人资料、我的订单、消息通知、我的收藏、我的评价
- ✅ 显示用户统计信息

### TC-F009-002: 个人信息编辑
**前置条件**: 用户已登录
**测试步骤**:
1. 点击"编辑资料"按钮
2. 修改用户名
3. 保存修改

**预期结果**:
- ✅ 弹出编辑表单
- ✅ 保存后信息更新

### TC-F009-003: 我的订单查看
**前置条件**: 用户已登录且有订单
**测试步骤**:
1. 点击"我的订单"标签

**预期结果**:
- ✅ 显示订单列表
- ✅ 显示订单状态、金额、日期

### TC-F009-004: 未登录访问用户中心
**测试步骤**:
1. 清除登录状态
2. 访问用户中心页面

**预期结果**:
- ✅ 重定向到登录页面
- ✅ 登录成功后返回用户中心

---

## 四、F010 - 评价系统

### TC-F010-001: 民宿详情页评价展示
**测试步骤**:
1. 打开任意民宿详情页
2. 滚动到评价区域

**预期结果**:
- ✅ 显示评价标题"Reviews"
- ✅ 显示综合评分
- ✅ 显示评价数量
- ✅ 评价列表正常显示

### TC-F010-002: 我的评价查看
**前置条件**: 用户已登录
**测试步骤**:
1. 进入用户中心
2. 点击"我的评价"标签

**预期结果**:
- ✅ 显示用户发表的评价列表
- ✅ 显示民宿名称、评分、内容、日期

---

## 五、F011 - 消息通知

### TC-F011-001: 消息通知页面
**前置条件**: 用户已登录
**测试步骤**:
1. 进入用户中心
2. 点击"消息通知"标签

**预期结果**:
- ✅ 显示通知列表
- ✅ 未读通知有特殊标记
- ✅ 显示通知类型、内容、时间

### TC-F011-002: 通知铃铛图标
**前置条件**: 用户已登录
**测试步骤**:
1. 查看导航栏

**预期结果**:
- ✅ 导航栏显示通知铃铛图标
- ✅ 有未读消息时显示红点数字

---

## 六、F017 - 搜索优化

### TC-F017-001: 关键词搜索
**测试步骤**:
1. 打开搜索页面 `/#/search`
2. 输入关键词"beach"
3. 按回车

**预期结果**:
- ✅ 搜索框可用
- ✅ 显示相关结果
- ✅ 结果与关键词匹配

### TC-F017-002: 分类筛选
**测试步骤**:
1. 打开民宿列表页
2. 点击分类按钮（Beach、City等）

**预期结果**:
- ✅ 分类按钮可点击
- ✅ 筛选结果更新

### TC-F017-003: 高级筛选
**测试步骤**:
1. 打开搜索页面
2. 点击"Filters"按钮
3. 设置筛选条件
4. 应用筛选

**预期结果**:
- ✅ 筛选面板弹出
- ✅ 可以设置多个筛选条件
- ✅ 应用后结果更新

---

## 七、F018 - 收藏功能

### TC-F018-001: 收藏民宿
**前置条件**: 用户已登录
**测试步骤**:
1. 打开民宿列表页
2. 点击房源卡片上的收藏按钮（心形图标）

**预期结果**:
- ✅ 心形按钮可点击
- ✅ 点击后变为已收藏状态（填充红色）
- ✅ 显示收藏成功提示

### TC-F018-002: 取消收藏
**前置条件**: 用户已登录且已收藏
**测试步骤**:
1. 找到已收藏的民宿
2. 点击已收藏的心形按钮

**预期结果**:
- ✅ 点击后取消收藏
- ✅ 按钮变为未收藏状态

### TC-F018-003: 未登录收藏
**测试步骤**:
1. 未登录状态下点击收藏按钮

**预期结果**:
- ✅ 提示需要登录
- ✅ 跳转到登录页面

---

## 八、F019 - 多语言完善

### TC-F019-001: 语言切换菜单
**测试步骤**:
1. 打开任意页面
2. 点击导航栏语言切换按钮

**预期结果**:
- ✅ 语言按钮可点击
- ✅ 弹出语言选择菜单
- ✅ 显示三种语言：ไทย、English、中文

### TC-F019-002: 切换到英语
**测试步骤**:
1. 点击语言切换按钮
2. 选择"English"

**预期结果**:
- ✅ 页面语言切换为英语
- ✅ 导航栏、按钮、标签都显示英文

### TC-F019-003: 切换到泰语
**测试步骤**:
1. 点击语言切换按钮
2. 选择"ไทย"

**预期结果**:
- ✅ 页面语言切换为泰语
- ✅ 泰语文本正确显示

### TC-F019-004: 切换到中文
**测试步骤**:
1. 点击语言切换按钮
2. 选择"中文"

**预期结果**:
- ✅ 页面语言切换为中文
- ✅ 中文文本正确显示

### TC-F019-005: 语言切换持久化
**测试步骤**:
1. 切换到英语
2. 刷新页面

**预期结果**:
- ✅ 刷新后语言保持英语

---

## 九、F020 - 移动端适配

### TC-F020-001: iPhone 首页显示
**测试步骤**:
1. 使用 iPhone 尺寸（375x812）打开首页

**预期结果**:
- ✅ 页面正常显示无横向滚动
- ✅ 导航栏显示移动端菜单按钮
- ✅ 房源卡片单列显示

### TC-F020-002: iPad 首页显示
**测试步骤**:
1. 使用 iPad 尺寸（768x1024）打开首页

**预期结果**:
- ✅ 页面正常显示
- ✅ 布局适配平板

### TC-F020-003: Android 设备显示
**测试步骤**:
1. 使用 Pixel 7 尺寸（412x915）打开首页

**预期结果**:
- ✅ 页面正常显示
- ✅ 触摸交互正常

---

## 十、管理后台功能

### TC-ADMIN-001: 管理员登录
**测试步骤**:
1. 访问 `/#/admin/login`
2. 输入管理员账号密码
3. 登录

**预期结果**:
- ✅ 登录成功
- ✅ 跳转到管理后台首页
- ✅ 显示 Dashboard

### TC-ADMIN-002: 成本管理
**前置条件**: 管理员已登录
**测试步骤**:
1. 点击"财务管理"
2. 查看成本列表

**预期结果**:
- ✅ 显示成本管理页面
- ✅ 显示成本列表和统计

### TC-ADMIN-003: 运营报表
**前置条件**: 管理员已登录
**测试步骤**:
1. 点击"Dashboard"
2. 查看报表数据

**预期结果**:
- ✅ 显示收入趋势图
- ✅ 显示订单统计
- ✅ 日期筛选可用

---

## 执行说明

**测试环境**:
- 前端: http://localhost:5173
- 后端: http://localhost:3000

**测试账号**:
- 普通用户: test@example.com / password123
- 管理员: admin / admin123

**测试工具**: agent-browser CLI with --headed flag

**移动设备测试**:
- iPhone 13 (390x844)
- iPhone SE (375x667)
- iPad Pro (1024x1366)
- Pixel 7 (412x915)
- Galaxy S24 (360x780)
