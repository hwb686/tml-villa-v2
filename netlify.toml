[build]
# 使用 npm ci 保证依赖锁定一致性，构建速度更快
command = "cd app && npm ci && npx vite build"
publish = "app/dist"

[build.environment]
NODE_VERSION = "20"
# 环境变量建议在 Netlify 后台 Site settings > Environment variables 中配置
# 以下仅作为 fallback（anon key 设计上可公开）
VITE_SUPABASE_FUNCTIONS_URL = "https://tlorpxejqqmrdcfgvyhl.supabase.co/functions/v1"
VITE_SUPABASE_URL = "https://tlorpxejqqmrdcfgvyhl.supabase.co"
VITE_SUPABASE_ANON_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InRsb3JweGVqcXFtcmRjZmd2eWhsIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzE0MjAwODksImV4cCI6MjA4Njk5NjA4OX0.5L5cR4G2D0xQz8d04eOREe5ud-AtSZqOaybfoROjGSw"
VITE_SUPABASE_BUCKET = "homestay-images"
VITE_API_BASE_URL = "https://tml-villa-api-d279.onrender.com"

[[redirects]]
from = "/api/*"
to = "https://tml-villa-api-d279.onrender.com/api/:splat"
status = 200

[[redirects]]
from = "/*"
to = "/index.html"
status = 200
